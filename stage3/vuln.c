/*
* vuln.c
*
* Coded by TeamCR@K
*
* http://teamcrak.tistory.com
*
* - A example code for insecure file creation vulnerability
*/
#include <stdio.h>
#include <dirent.h>

int main(int argc, char **argv)
{
	DIR *dp;
	FILE *fp = NULL;
	char logfile[1024];

	snprintf(logfile, sizeof(logfile), "logs/%s.log", argv[0]);

	if((fp = fopen(logfile, "a+")) != NULL) {
		fputs("Write log contents!\n", fp);
		fclose(fp);
	}
	return 0;
}
